{% extends 'localcosmos_server/modals/modal_form.html' %}

{% load i18n localcosmos_tags app_tags %}

{% block above %}
	<form method="POST" action="{% url 'manage_app_theme_image' meta_app.id image_type %}" enctype="multipart/form-data" class="xhr">{% csrf_token %}
{% endblock %}

{% block title %}
	{{ image_name }}
{% endblock %}

{% block body %}
	<p>
		{% render_bootstrap_form form %}
	</p>
{% endblock %}

{% block footer %}
	<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">{% trans 'Cancel' %}</button>
	{% if content_image %}
		<a href="#" data-url="{% url 'delete_app_theme_image' content_type.id content_image.pk %}" ajax-target="ModalContent" class="btn btn-danger xhr">{% trans 'Delete' %}</a>
	{% endif %}
	<button type="submit" class="btn btn-outline-primary">{% trans 'Save' %}</button>
{% endblock %}

{% block script %}
	<script>
		{% if form.is_valid %}
			
			var url = "{% url 'get_app_theme_image_formfield' meta_app.id image_type %}";
			$.get(url, function(html){
				$("#field-id_{{ image_type }}-container").replaceWith(html);
				ajaxify('field-id_{{ image_type }}-container');
			});

			$("#Modal").modal("hide");
			$("#ModalContent").empty();
			
		{% endif %}
	</script>
{% endblock %}
